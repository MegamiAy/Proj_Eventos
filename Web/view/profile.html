<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="icon" href="../src/img/white_logo.PNG" type="image/x-icon">
    <title>EVENTOS | KAYA</title>
    <link rel="stylesheet" href="../src/css/global.css">
    <link rel="stylesheet" href="../src/css/profile.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css">
</head>
<body>
<header id="header">
    <!-- O conteúdo do cabeçalho será carregado aqui -->
</header>
<main>
    <div class="inner-title">
        <h2>PERFIL</h2>
    </div>

    <div class="profile">
        <div class="p-container">
            <div class="p-init-left">
                <div class="p-photo">
                    <img src="../src/img/profile.jpg" alt="profile" title="profile">
                    <button class="p-edit-button">
                        <i class="fas fa-edit"></i>
                    </button>
                </div>
                <div class="p-info">
                    <p class="p-name">Nome do Usuário</p>
                    <p class="username">@nome_do_usuário</p>
                </div>
            </div>
            <div class="p-init-right">
                <h2>INFORMAÇÕES PESSOAIS ADICIONAIS</h2>
                <form id="myForm" action="">
                    <div class="p-additional-info">
                        <div class="p-field">
                            <label for="cpf">CPF</label>
                            <input type="text" id="cpf" name="cpf" placeholder="000.000.000-00" maxlength="14">
                            <span class="error" id="cpfError"></span>    
                        </div>
                        <div class="p-field">
                            <label for="phone">Telefone</label>
                            <input type="text" id="phone" name="phone" placeholder="(00) 00000-0000" maxlength="15">
                            <span class="error" id="phoneError"></span>
                        </div>
                        <div class="p-field">
                            <label for="birth">Nascimento</label>
                            <input type="date" id="birth" name="birth">
                            <span class="error" id="birthError"></span>
                        </div>
                        <div class="p-field">
                            <label for="cep">CEP</label>
                            <input type="text" id="cep" name="cep" placeholder="00000-000" maxlength="9">
                            <span class="error" id="cepError"></span>
                        </div>
                        <div class="p-button-container">
                            <input type="submit" value="SALVAR" class="p-save-button">
                        </div>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Meus Eventos -->

    <!-- Eventos Salvos -->

</main>
<footer id="footer"></footer>

<script>
    // Função para formatar CPF
    function formatCPF(cpf) {
        cpf = cpf.replace(/\D/g, ''); // Remove tudo que não é dígito
        cpf = cpf.replace(/(\d{3})(\d)/, '$1.$2'); // Coloca o primeiro ponto
        cpf = cpf.replace(/(\d{3})(\d)/, '$1.$2'); // Coloca o segundo ponto
        cpf = cpf.replace(/(\d{3})(\d{1,2})$/, '$1-$2'); // Coloca o traço
        return cpf;
    }

    // Função para formatar telefone
    function formatPhone(phone) {
        phone = phone.replace(/\D/g, ''); // Remove tudo que não é dígito
        phone = phone.replace(/(\d{2})(\d)/, '($1) $2'); // Coloca os parênteses
        phone = phone.replace(/(\d{5})(\d)/, '$1-$2'); // Coloca o traço
        return phone;
    }

    // Função para formatar CEP
    function formatCEP(cep) {
        cep = cep.replace(/\D/g, ''); // Remove tudo que não é dígito
        cep = cep.replace(/^(\d{5})(\d{3})/, '$1-$2'); // Coloca o traço apenas antes dos últimos 3 dígitos
        return cep;
    }

    // Função para validar CPF
    function validarCPF(cpf) {
        cpf = cpf.replace(/\D/g, ''); // Remove todos os caracteres não numéricos
        if (cpf.length !== 11 || /^(\d)\1{10}$/.test(cpf)) {
            return false; // CPF deve ter 11 dígitos e não pode ter todos os dígitos iguais
        }

        // Validação do primeiro dígito verificador
        let add = 0;
        for (let i = 0; i < 9; i++) {
            add += parseInt(cpf.charAt(i)) * (10 - i);
        }
        let rev = 11 - (add % 11);
        if (rev === 10 || rev === 11) {
            rev = 0;
        }
        if (rev !== parseInt(cpf.charAt(9))) {
            return false; // Primeiro dígito verificador inválido
        }

        // Validação do segundo dígito verificador
        add = 0;
        for (let i = 0; i < 10; i++) {
            add += parseInt(cpf.charAt(i)) * (11 - i);
        }
        rev = 11 - (add % 11);
        if (rev === 10 || rev === 11) {
            rev = 0;
        }
        if (rev !== parseInt(cpf.charAt(10))) {
            return false; // Segundo dígito verificador inválido
        }

        return true; // CPF válido
    }

    // Adicionando event listeners para formatar os campos
    document.getElementById('cpf').addEventListener('input', function() {
        this.value = formatCPF(this.value);
    });

    document.getElementById('phone').addEventListener('input', function() {
        this.value = formatPhone(this.value);
    });

    document.getElementById('cep').addEventListener('input', function() {
        this.value = formatCEP(this.value);
    });

    // Event listener para validação do formulário
    document.getElementById('myForm').addEventListener('submit', function(event) {
        let valid = true;

        // CPF Validation
        const cpf = document.getElementById('cpf').value;
        const cpfError = document.getElementById('cpfError');
        if (!validarCPF(cpf)) {
            cpfError.textContent = 'CPF inválido. Verifique o formato e os dígitos verificadores.';
            valid = false;
        } else {
            cpfError.textContent = '';
        }

        // Phone Validation
        const phone = document.getElementById('phone').value;
        const phoneError = document.getElementById('phoneError');
        if (!/^\(\d{2}\) \d{5}-\d{4}$/.test(phone)) {
            phoneError.textContent = 'Telefone inválido. Formato correto: (00) 00000-0000';
            valid = false;
        } else {
            phoneError.textContent = '';
        }

        // Birth Date Validation
        const birth = document.getElementById('birth').value;
        const birthError = document.getElementById('birthError');
        if (!birth) {
            birthError.textContent = 'Data de nascimento é obrigatória.';
            valid = false;
        } else {
            const birthDate = new Date(birth);
            const currentDate = new Date();
            if (birthDate >= currentDate) {
                birthError.textContent = 'Data de nascimento não pode ser no futuro.';
                valid = false;
            } else {
                birthError.textContent = '';
            }
        }

        // CEP Validation
        const cep = document.getElementById('cep').value;
        const cepError = document.getElementById('cepError');
        if (!/^\d{5}-\d{3}$/.test(cep)) {
            cepError.textContent = 'CEP inválido. Formato correto: 00000-000';
            valid = false;
        } else {
            cepError.textContent = '';
        }

        // Exibir mensagem de sucesso se o formulário for válido
        if (valid) {
            alert('Informações salvas com sucesso!');
        }

        // Impedir o envio do formulário se houver campos inválidos
        if (!valid) {
            event.preventDefault();
        }
    });
</script>



<script src="../src/js/scriptProfile.js"></script>
</body>
</html>
